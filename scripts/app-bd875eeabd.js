function popupController(t,e,r){function n(){t.close()}function a(){t.close()}function i(){e.wrapper.removeActiveArea(r),a()}function o(t){return t.getTime().toString()}function c(){l.area.parameters.paramsValues.hasOwnProperty("date")&&(l.area.parameters.paramsValues.date=o(l.dateModel)),r.changeContent(l.area),a()}function s(){l.datapickerOpened=!0}var l=this;l.cancelPopup=n,l.closePopup=a,l.deleteActiveArea=i,l.area=angular.copy(r),l.changeContent=c,l.openDatapicker=s,l.datapickerOptions={},l.dateModel=new Date,l.dateModel.setTime(parseInt(l.area.parameters.paramsValues.date)||void 0)}function routesConfig(t,e,r){r.html5Mode(!0).hashPrefix("!"),e.otherwise("/"),t.state("main",{url:"/",controller:"mainController",controllerAs:"ctrl",templateUrl:"app/main.html"})}popupController.$inject=["$uibModalInstance","mainService","area"],routesConfig.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],function(){"use strict";angular.module("wrapper",[])}(),function(){"use strict";function t(t){var e=this;e.addActiveArea=t.addNewActiveArea,t.createDefaultWrapper().then(function(t){e.wrapper=t},function(t){console.log(t)})}t.$inject=["mainService"],angular.module("wrapper").component("wrapper",{templateUrl:"app/wrapper/wrapper.html",controller:t,controllerAs:"ctrl"})}(),angular.module("app",["ui.router","main","ui.bootstrap"]),function(){"use strict";function t(t){function e(e,n,a,i,o){r.modalInstance=t.open({templateUrl:n,controller:a,backdrop:!1,animation:!1,keyboard:!1,resolve:{area:function(){return o}},controllerAs:"ctrl",size:e,windowClass:i})}var r=this;return r.modalInstance=null,{openPopup:e}}t.$inject=["$uibModal"],angular.module("app").factory("popupFactory",t)}(),function(){"use strict";angular.module("main",["wrapper"])}(),function(){"use strict";function t(t,e,r){return{restrict:"A",link:function(t,n,a){function i(t){var e=50;return o.x+t.width>s.width&&(t.width=s.width-o.x),t.width<e&&(t.width=e),o.y+t.height>s.height&&(t.height=s.height-o.y),t.height<e&&(t.height=e),t}var o=e.wrapper.getActiveAreaById(a.activeAreaId),c=angular.element("<div/>");c.css({left:e.intToPx(o.width),top:e.intToPx(o.height)}),c.addClass("resize-btn");var s=n.parent()[0].getBoundingClientRect(),l=new Hammer(c[0]),p={};l.get("pan").set({direction:Hammer.DIRECTION_ALL}),l.on("pan",function(t){t.preventDefault(),t.srcEvent.stopPropagation();var r=e.wrapper.targetIsActiveArea("resize",t,n.parent()[0],o);t.target==n.parent()[0]||r||(p.width=o.width+t.deltaX,p.height=o.height+t.deltaY,p=i(p),n.css({width:e.intToPx(p.width),height:e.intToPx(p.height)}),c.css({left:e.intToPx(p.width),top:e.intToPx(p.height)}))}),l.on("panend",function(t){o.updateSize(p.width,p.height)}),r(c)(t),n.append(c)}}}t.$inject=["$document","mainService","$compile"],angular.module("main").directive("resize",t)}(),function(){"use strict";function t(t,e){return{link:function(r,n,a){n.on("change",function(r){r.target.files;t.getWrapper().randomBackground(),e.$apply(),r.target.value=null})}}}t.$inject=["mainService","$rootScope"],angular.module("main").directive("fileInput",t)}(),function(){"use strict";function t(t,e){return{restrict:"A",link:function(t,r,n){function a(t){r.css({left:e.intToPx(t.x),top:e.intToPx(t.y)})}function i(t){var r=e.getWrapperSize();return t.x<0&&(t.x=0),t.x>r.width-o.width&&(t.x=r.width-o.width),t.y<0&&(t.y=0),t.y>r.height-o.height&&(t.y=r.height-o.height),t}var o=e.wrapper.getActiveAreaById(n.activeAreaId),c={},s=new Hammer(r[0]);s.get("pan").set({direction:Hammer.DIRECTION_ALL}),s.on("panstart",function(t){var n=e.wrapper.targetIsActiveArea("drag",t,r.parent()[0],o);t.target!=r.parent()[0]&&n?(t.preventDefault(),t.srcEvent.stopPropagation(),s.on("panmove",function(t){c.x=o.x+t.deltaX,c.y=o.y+t.deltaY,c=i(c),a(c)}),s.on("panend",function(t){o.updateCoords(c.x,c.y)})):(s.off("panmove"),s.off("panend"))})}}}t.$inject=["$document","mainService"],angular.module("main").directive("drag",t)}(),function(){"use strict";function t(t,e,r){return{restrict:"A",link:function(n,a,i){var o=angular.element("<div/>");o.css({left:e.intToPx(-6),top:e.intToPx(-6)}),o.addClass("delete-btn");var c=new Hammer(o[0]);c.on("tap",function(t){var n=e.wrapper.getActiveAreaById(i.activeAreaId),a="app/modal/confirmDeletePopup.html";r.openPopup("",a,popupController,"center-modal",n)}),t(o)(n),a.append(o)}}}t.$inject=["$compile","mainService","popupFactory"],angular.module("main").directive("deleteBtn",t)}(),function(){"use strict";function t(t,e){return{restrict:"A",link:function(r,n,a){var i=new Hammer(n[0]);i.get("tap").set({taps:1}),i.on("tap",function(r){var i=t.wrapper.getActiveAreaById(a.activeAreaId),o=t.wrapper.targetIsActiveArea("drag",r,n.parent()[0],i);if(o&&"delete-btn"!=r.target.classList[0]){var c="app/modal/changeContent"+i.parameters.action.ActionIdentifier+".html";e.openPopup("",c,popupController,"center-modal",i)}})}}}t.$inject=["mainService","popupFactory"],angular.module("main").directive("changeContent",t)}(),function(){"use strict";function t(t,e,r){function n(t){return t.toString()+"px"}function a(t){this.parameters=t,this.activeAreasList=[]}function i(t){var e=document.documentElement,r=t.getBoundingClientRect(),n=r.top+window.pageYOffset-e.clientTop,a=r.left+window.pageXOffset-e.clientLeft;return{top:n,left:a}}function o(){return{width:x.wrapper.parameters.ActionSetWidth,height:x.wrapper.parameters.ActionSetHeight}}function c(){return x.wrapper}function s(){return l().then(function(t){return x.wrapper=new a(t),x.wrapper})}function l(t){return d(r+k).then(function(e){var r=e.data.ActionSets[0];return t?p(r,t):p(r,r)},function(t){return t.data})}function p(t,r){var n=angular.copy(r),a=e.screen.width;switch(e.devicePixelRatio<1&&(a=e.screen.width),!0){case a>t.MaxActionSetWidth:n.ActionSetWidth=t.MaxActionSetWidth;break;case a<t.MaxActionSetWidth&&a>t.ActionSetWidth:n.ActionSetWidth=a;break;default:n.ActionSetWidth=t.ActionSetWidth}return x.Percentage=100*n.ActionSetWidth/t.ActionSetWidth,n.ActionSetHeight=t.ActionSetHeight*x.Percentage/100,n}function d(e){return t.get(e)}function u(t){this.id=x.wrapper.getNextId(),this.parameters=t,this.x=parseInt(t.ActionButtonPosX),this.y=parseInt(t.ActionButtonPosY),this.width=parseInt(t.ActionButtonWidth),this.height=parseInt(t.ActionButtonHeight),this.type=t.ActionName}function h(t){t.x*=x.Percentage/100,t.y*=x.Percentage/100,t.width*=x.Percentage/100,t.height*=x.Percentage/100}function g(t){d(r+P[t]).then(function(t){m(t.data)},function(t){return console.log(t.data),t.data})}function m(t){var e=new u(t);h(e),x.wrapper.activeAreasList.push(e)}function f(t){var e=r+t+".json";d(e).then(function(t){t.data=t.data.ActionSets[0],t.data.ActionSetWidth=x.wrapper.parameters.ActionSetWidth,t.data.ActionSetHeight=x.wrapper.parameters.ActionSetHeight,v(t.data)},function(t){console.log(t.data)})}function v(t){x.wrapper.parameters=t,x.wrapper.activeAreasList=[];for(var e=0;e<t.ActionSetActions.length;e++)m(t.ActionSetActions[e])}function b(){var t={ActionSets:[]};t.ActionSets.push(angular.copy(x.wrapper.parameters));var e=x.wrapper.getActiveAreas(),r=[];angular.forEach(e,function(t){var e=w(t);r.push(e)}),t.ActionSets[0].ActionSetActions=r,S(t.ActionSets[0]),y(t,"newJson.json")}function w(t){var e=t.parameters;return e.ActionButtonPosX=Math.floor(A(t.x)).toString(),e.ActionButtonPosY=Math.floor(A(t.y)).toString(),e.ActionButtonWidth=Math.floor(A(t.width)).toString(),e.ActionButtonHeight=Math.floor(A(t.height)).toString(),e}function A(t){return x.Percentage?t/(x.Percentage/100):t}function y(t,e){if(!t)return void console.error("No data");e||(e="download.json"),"object"==typeof t&&(t=JSON.stringify(t,void 0,2));var r=new Blob([t],{type:"text/json"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(r,e);else{var n=document.createEvent("MouseEvents"),a=document.createElement("a");a.download=e,a.href=window.URL.createObjectURL(r),a.dataset.downloadurl=["text/json",a.download,a.href].join(":"),n.initEvent("click",!0,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),a.dispatchEvent(n)}}function S(t){delete t.ActionSetWidth,delete t.ActionSetHeight,delete t.MaxActionSetWidth,delete t.MinActionSetWidth}var x=this;x.createDefaultWrapper=s,x.intToPx=n,x.getWrapper=c,x.getWrapperSize=o,x.getConfig=d,x.Percentage=0,x.backgoundId=0,x.addNewActiveArea=g,x.redrawWrapper=f,x.generateJson=b;var P={url:"UrlDefaults.json",event:"EventDefaults.json"},k="WrapperDefaults.json";a.prototype.getWidthStr=function(){return n(this.parameters.ActionSetWidth)},a.prototype.getHeightStr=function(){return n(this.parameters.ActionSetHeight)},a.prototype.getBackgroundImage=function(){return this.parameters.ActionSetImage},a.prototype.getNextId=function(){return this.activeAreasList.length>0?this.activeAreasList.length:0},a.prototype.getActiveAreas=function(){return this.activeAreasList},a.prototype.getActiveAreaById=function(t){return t<this.activeAreasList.length&&t>=0?this.activeAreasList[t]:void 0},a.prototype.removeActiveArea=function(t){var e=this.activeAreasList.indexOf(t);if(e>-1){this.activeAreasList.splice(e,1);for(var r=e;r<this.activeAreasList.length;r++)this.activeAreasList[r].id-=1}},a.prototype.randomBackground=function(){var t=["https://thumbs.dreamstime.com/z/teaser-advertisement-background-banners-21158204.jpg","http://static.tumblr.com/dd5e8430357503dbcbe8b43a8050fe1f/bycoc1i/LHVog7qzv/tumblr_static_628l7k8r2y4o0c8k0os0s000k_2048_v2.jpg","http://i.imgur.com/35lwnmR.jpg"],e=Object.keys(t),r=e[Math.floor(Math.random()*e.length)];this.backgoundId==r&&(r=e[Math.floor(Math.random()*(e.length-parseInt(r)+1))]),this.parameters.ActionSetImage=t[r],this.backgoundId=r},a.prototype.targetIsActiveArea=function(t,e,r,n){var a=r.getBoundingClientRect();"drag"==t&&(a=i(r));var o=7,c={x:e.changedPointers[0].pageX-e.deltaX,y:e.changedPointers[0].pageY-e.deltaY};return c.x>=a.left+n.x&&c.x<=a.left+n.x+n.width-o&&c.y>=a.top+n.y&&c.y<=a.top+n.y+n.height-o},u.prototype.getWidthStr=function(){return n(this.width)},u.prototype.getHeightStr=function(){return n(this.height)},u.prototype.getXStr=function(){return n(this.x)},u.prototype.getYStr=function(){return n(this.y)},u.prototype.getColor=function(){return this.parameters.paramsValues.hasOwnProperty("url")?"rgba(118, 69, 160, 0.4)":this.parameters.paramsValues.hasOwnProperty("EventTitle")?"rgba(35, 92, 202, 0.4)":void 0},u.prototype.updateSize=function(t,e){this.width=parseInt(t),this.height=parseInt(e)},u.prototype.getContent=function(){return this.parameters.paramsValues.url?this.parameters.paramsValues.url:this.parameters.paramsValues.EventTitle?this.parameters.paramsValues.EventTitle:void 0},u.prototype.changeContent=function(t){for(var e in this.parameters.paramsValues)this.parameters.paramsValues.hasOwnProperty(e)&&this.parameters.paramsValuesDefs.hasOwnProperty(e)&&(this.parameters.paramsValues[e]=t.parameters.paramsValues[e],this.parameters.paramsValuesDefs[e].ActionParamsValue=this.parameters.paramsValues[e])},u.prototype.updateCoords=function(t,e){"string"==typeof t&&t.indexOf("px")!=-1&&t.replace("px",""),"string"==typeof e&&e.indexOf("px")!=-1&&e.replace("px",""),this.x=parseInt(t),this.y=parseInt(e)}}t.$inject=["$http","$window","CONFIG_PATH"],angular.module("main").service("mainService",t)}(),function(){"use strict";function t(t){function e(e){t.redrawWrapper(e)}var r=this;r.redrawWrapper=e,r.generateJson=t.generateJson}t.$inject=["mainService"],angular.module("main").controller("mainController",t)}(),angular.module("app").run(["$templateCache",function(t){t.put("app/main.html",'<div class="row">\r\n  <div class="container">\r\n    <div class="col-xs-12" align="center">\r\n      <div class="row static-urls">\r\n        <div class="row form-group" align="justify">\r\n          <span>Presets:</span>\r\n          <button type="button" class="btn btn-static-urls" ng-click="ctrl.redrawWrapper(\'iAD1\')">iAd 1</button>\r\n          <button type="button" class="btn btn-static-urls" ng-click="ctrl.redrawWrapper(\'iAD2\')">iAd 2</button>\r\n          <button type="button" class="btn btn-static-urls" ng-click="ctrl.redrawWrapper(\'iAD3\')">iAd 3</button>\r\n        </div>\r\n        <div class="row" align="justify">\r\n          <button type="button" class="btn btn-download" ng-click="ctrl.generateJson()">Download JSON</button>\r\n        </div>\r\n      </div>\r\n      <div class="row">\r\n        <div class="col-md-12">\r\n          <wrapper></wrapper>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n'),t.put("app/modal/changeContentAddToCalendar.html",'<div class="modal-header">\r\n    <button type="button" data-ng-click="ctrl.closePopup()" class="close" data-dismiss="modal" aria-label="Close">\r\n      <span aria-hidden="true">&times;</span>\r\n    </button>\r\n    <h3 class="modal-title text-warning">Change content</h3>\r\n</div>\r\n<div class="modal-body">\r\n    <form data-toggle="validator" name="form" role="form">\r\n        <div class="form-group" ng-class="{ \'has-error\': form.title.$invalid }">\r\n            <label for="title">Title</label>\r\n            <input class="form-control" id="title" name="title" type="text" placeholder="New Title" ng-model="ctrl.area.parameters.paramsValues.EventTitle" required>\r\n        </div>\r\n\r\n        <div class="form-group" ng-class="{ \'has-error\': form.address.$invalid }">\r\n            <label for="address">Address</label>\r\n            <input class="form-control" id="address" name="address" type="text" placeholder="New Adress" ng-model="ctrl.area.parameters.paramsValues.address" required>\r\n        </div>\r\n\r\n        <div class="form-group" ng-class="{ \'has-error\': form.dateEvent.$invalid }">\r\n            <label for="datapicker">Date</label>\r\n            <p class="input-group" id="datapicker">\r\n              <input type="text" class="form-control" name="dateEvent" uib-datepicker-popup="dd-MMMM-yyyy" ng-model="ctrl.dateModel" is-open="ctrl.datapickerOpened" required>\r\n              <span class="input-group-btn">\r\n                <button type="button" class="btn btn-default" ng-click="ctrl.openDatapicker()"><i class="glyphicon glyphicon-calendar"></i></button>\r\n              </span>\r\n            </p>\r\n        </div>\r\n    </form>\r\n\r\n</div>\r\n<div class="modal-footer">\r\n    <button type="button" class="btn btn-default" data-dismiss="modal" data-ng-click="ctrl.cancelPopup()">Cancel</button>\r\n    <button type="submit" class="btn btn-default" data-ng-click="ctrl.changeContent()">Change</button>\r\n</div>\r\n'),t.put("app/modal/changeContentOpenURL.html",'<div class="modal-header">\r\n    <button type="button" data-ng-click="ctrl.closePopup()" class="close" data-dismiss="modal" aria-label="Close">\r\n      <span aria-hidden="true">&times;</span>\r\n    </button>\r\n    <h3 class="modal-title text-warning">Change content</h3>\r\n</div>\r\n<form data-toggle="validator" name="form" role="form">\r\n    <div class="modal-body">\r\n        <div class="form-group" ng-class="{ \'has-error\': form.url.$invalid }">\r\n            <label for="url">URL</label>\r\n            <input class="form-control" id="url" name="url" type="url" placeholder="New URL" ng-model="ctrl.area.parameters.paramsValues.url" required>\r\n        </div>\r\n    </div>\r\n    <div class="modal-footer form-group">\r\n        <button type="button" class="btn btn-default" data-dismiss="modal" data-ng-click="ctrl.cancelPopup()">Cancel</button>\r\n        <button type="submit" class="btn btn-default" ng-disabled="form.$invalid" data-ng-click="ctrl.changeContent()">Change</button>\r\n    </div>\r\n</form>'),t.put("app/modal/confirmDeletePopup.html",'<div class="modal-header">\r\n    <button type="button" data-ng-click="ctrl.closePopup()" class="close" data-dismiss="modal" aria-label="Close">\r\n      <span aria-hidden="true">&times;</span>\r\n    </button>\r\n    <h3 class="modal-title text-warning">Confirm delete</h3>\r\n</div>\r\n<div class="modal-body">\r\n    <p>Are you sure you want to delete this active area?</p>\r\n</div>\r\n<div class="modal-footer">\r\n    <button type="button" class="btn btn-default" data-dismiss="modal" data-ng-click="ctrl.cancelPopup()">Cancel</button>\r\n    <button type="submit" class="btn btn-danger" data-ng-click="ctrl.deleteActiveArea()">Delete</button>\r\n</div>'),t.put("app/wrapper/wrapper.html",'<div class="row wrapper-content" ng-style="{\r\n                            \'width\': ctrl.wrapper.getWidthStr(),\r\n                            \'height\': ctrl.wrapper.getHeightStr(),\r\n                            \'background\': \'url(\'+ctrl.wrapper.getBackgroundImage()+\')  100% 100% no-repeat\',\r\n                            \'background-size\': \'cover\',\r\n                            \'background-position\': \'center center\'\r\n                            }">\r\n     <div ng-repeat="active_area in ctrl.wrapper.getActiveAreas()" class="active-area" ng-style="{\'width\': active_area.getWidthStr(),\r\n                  \'height\': active_area.getHeightStr(),\r\n                  \'left\': active_area.getXStr(),\r\n                  \'top\': active_area.getYStr(),\r\n                  \'background-color\': active_area.getColor()}" drag resize delete-btn change-content active-area="{{active_area}}" active-area-id="{{active_area.id}}">\r\n         <p class="area-title"> {{active_area.getContent()}}</p>\r\n    </div>\r\n    <div class="btn-group-new-item">\r\n        <a type="button" class="btn" ng-click="ctrl.addActiveArea(\'url\')"><i class="fa fa-2x fa-globe add-item" aria-hidden="true"></i></a>\r\n        <a type="button" class="btn" ng-click="ctrl.addActiveArea(\'event\')"><i class="btn-add-event fa fa-2x fa-calendar-check-o add-item" aria-hidden="true"></i></a>\r\n        <label for="file-upload" class="custom-file-upload btn"><i class="fa fa-2x fa-picture-o add-item"></i></label>\r\n        <input file-input id="file-upload" type="file">\r\n        <a type="button" class="btn plus"><i class="fa fa-2x fa-plus btn-menu" aria-hidden="true"></i></a>\r\n    </div>\r\n</div>\r\n')}]),angular.module("app").config(routesConfig),function(){"use strict";angular.module("app").constant("CONFIG_PATH","app/config/")}();
//# sourceMappingURL=../maps/scripts/app-bd875eeabd.js.map
